<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nocturna Wheel Test (Global Hack)</title>
    <style>
        #chart-container {
            width: 600px;
            height: 600px;
            margin: 20px auto;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <div id="chart-container"></div>

    <!-- Global Class Stubs - Hack to ensure classes are available -->
    <script>
        // Define a minimal ChartConfig class to make it available globally
        window.ChartConfig = class ChartConfig {
            constructor(customConfig = {}) {
                console.log("GLOBAL STUB ChartConfig constructor called");
                // This will be replaced by the real ChartConfig from the bundle
                // But having this ensures the constructor exists
            }
        };
        
        // Define other potential globals that might be needed
        window.SvgUtils = class SvgUtils {};
        window.AstrologyUtils = {
            getZodiacSigns: () => ["aries", "taurus", "gemini", "cancer", "leo", "virgo", "libra", "scorpio", "sagittarius", "capricorn", "aquarius", "pisces"],
            getPlanetSymbol: () => "",
            getZodiacSignFullName: () => "",
            getPlanetFullName: () => "",
            capitalizeFirstLetter: (str) => str.charAt(0).toUpperCase() + str.slice(1),
            houseToRoman: (num) => ["I", "II", "III", "IV", "V", "VI", "VII", "VIII", "IX", "X", "XI", "XII"][num - 1] || ""
        };
        window.PlanetPositionCalculator = {
            adjustOverlaps: () => []
        };
        window.HouseCalculator = class HouseCalculator {
            calculateHouseCusps() { return []; }
            getAvailableHouseSystems() { return []; }
        };
    </script>

    <!-- Nocturna Wheel Library -->
    <script src="dist/nocturna-wheel.umd.js"></script>

    <!-- Test script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            try {
                console.log('Testing NocturnaWheel bundle...');
                
                // Test if NocturnaWheel is available
                if (typeof NocturnaWheel === 'undefined') {
                    throw new Error('NocturnaWheel is not defined');
                }
                
                console.log('NocturnaWheel object:', NocturnaWheel);
                console.log('WheelChart available:', typeof NocturnaWheel.WheelChart === 'function');
                console.log('ChartConfig available globally:', typeof window.ChartConfig === 'function');
                console.log('ChartConfig available in bundle:', typeof NocturnaWheel.ChartConfig === 'function');
                
                // Get the constructors
                const { NocturnaWheel: NocturnaWheelClass, WheelChart } = NocturnaWheel;
                
                // Create a simple chart
                const chart = new WheelChart({
                    container: '#chart-container',
                    planets: {
                        sun: { lon: 85.83, color: '#000000' },
                        moon: { lon: 133.21, color: '#000000' }
                    },
                    houses: [
                        { lon: 300.32 },  // 1st house cusp
                        { lon: 330.15 },  // 2nd house cusp
                        { lon: 355.24 },  // 3rd house cusp
                        { lon: 20.32 },   // 4th house cusp
                        { lon: 45.15 },   // 5th house cusp
                        { lon: 75.24 },   // 6th house cusp
                        { lon: 120.32 },  // 7th house cusp
                        { lon: 150.15 },  // 8th house cusp
                        { lon: 175.24 },  // 9th house cusp
                        { lon: 200.32 },  // 10th house cusp
                        { lon: 225.15 },  // 11th house cusp
                        { lon: 255.24 }   // 12th house cusp
                    ],
                    aspectSettings: {
                        enabled: true,
                        orb: 6,
                        types: {
                            'conjunction': { angle: 0, orb: 8, color: '#000000', lineStyle: 'none', enabled: true, strokeWidth: 1 },
                            'opposition': { angle: 180, orb: 6, color: '#E41B17', lineStyle: 'solid', enabled: true, strokeWidth: 1 },
                            'trine': { angle: 120, orb: 6, color: '#4CC417', lineStyle: 'solid', enabled: true, strokeWidth: 1 },
                            'square': { angle: 90, orb: 6, color: '#F62817', lineStyle: 'dashed', enabled: true, strokeWidth: 1 },
                            'sextile': { angle: 60, orb: 4, color: '#56A5EC', lineStyle: 'dashed', enabled: true, strokeWidth: 1 }
                        }
                    },
                    config: {
                        assets: {
                            basePath: "./assets/",
                            showCardinalLabels: false
                        },
                        astronomicalData: {
                            ascendant: 300.32,
                            mc: 200.32,
                            latitude: 51.5
                        },
                        houseSettings: {
                            enabled: true,
                            lineColor: "#666666",
                            textColor: "#333333",
                            fontSize: 10,
                            rotationAngle: 0
                        }
                    }
                });

                // Render the chart
                chart.render();
                
                console.log('Chart rendered successfully');
                
                // Test some basic functionality
                setTimeout(() => {
                    console.log('Testing toggle functions...');
                    chart.togglePlanet('sun', false);
                    chart.toggleHouses(false);
                    chart.toggleAspects(false);
                    
                    setTimeout(() => {
                        console.log('Testing toggle functions back...');
                        chart.togglePlanet('sun', true);
                        chart.toggleHouses(true);
                        chart.toggleAspects(true);
                    }, 1000);
                }, 1000);
                
            } catch (error) {
                console.error('Error testing NocturnaWheel:', error);
            }
        });
    </script>
</body>
</html> 